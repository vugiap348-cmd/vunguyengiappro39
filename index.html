<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ƒê·ªÅ Ki·ªÉm Tra L·ªãch S·ª≠ ‚Äì ƒê·ªÅ S·ªë 38</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;0,900;1,400&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
<style>
  :root {
    --parchment:#f5ecd7;--parchment-dark:#e8d9b8;--ink:#1a0f00;--ink-light:#3d2b1a;
    --gold:#b8860b;--gold-light:#d4a017;--gold-bright:#f0c040;
    --red:#8b1a1a;--green:#1a4a1a;--green-light:#2d6a2d;--border:#8b6914;
  }
  *{box-sizing:border-box;margin:0;padding:0;}
  body{background:#0d0800;background-image:radial-gradient(ellipse at 20% 20%,rgba(184,134,11,.08) 0%,transparent 50%),radial-gradient(ellipse at 80% 80%,rgba(139,26,26,.06) 0%,transparent 50%);font-family:'Crimson Text',serif;min-height:100vh;color:var(--ink);overflow-x:hidden;}
  .top-border{height:6px;background:linear-gradient(90deg,transparent,var(--gold),var(--gold-bright),var(--gold),transparent);}
  .header{background:linear-gradient(180deg,#0d0800 0%,#1a0f00 60%,#2a1800 100%);padding:40px 20px 50px;text-align:center;position:relative;overflow:hidden;}
  .header::before{content:'';position:absolute;inset:0;background-image:url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none'%3E%3Cg fill='%23b8860b' fill-opacity='0.04'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");}
  .header-ornament{color:var(--gold);font-size:28px;letter-spacing:12px;margin-bottom:12px;opacity:.7;}
  .header h1{font-family:'Playfair Display',serif;font-size:clamp(22px,4vw,38px);font-weight:900;color:var(--gold-bright);text-shadow:0 0 40px rgba(212,160,23,.5),0 2px 4px rgba(0,0,0,.8);letter-spacing:3px;text-transform:uppercase;line-height:1.2;}
  .header h2{font-family:'Playfair Display',serif;font-size:clamp(14px,2.5vw,20px);color:var(--parchment-dark);font-weight:400;font-style:italic;margin-top:8px;opacity:.8;letter-spacing:1px;}
  .header-divider{width:300px;height:1px;background:linear-gradient(90deg,transparent,var(--gold),transparent);margin:20px auto;}

  /* ‚îÄ‚îÄ MUSIC PLAYER ‚îÄ‚îÄ */
  .music-player{position:fixed;top:18px;left:18px;z-index:999;display:flex;align-items:center;gap:0;}
  .mp-bubble{width:46px;height:46px;border-radius:50%;background:#000;border:2.5px solid #00e5ff;box-shadow:0 0 14px rgba(0,229,255,.4);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .35s cubic-bezier(.4,0,.2,1);flex-shrink:0;}
  .mp-bubble svg{width:20px;height:20px;fill:#00e5ff;}
  .mp-panel{max-width:0;overflow:hidden;opacity:0;transition:max-width .35s cubic-bezier(.4,0,.2,1),opacity .25s;display:flex;align-items:center;gap:10px;background:rgba(0,0,0,.88);border:1.5px solid rgba(0,229,255,.35);border-left:none;border-radius:0 28px 28px 0;padding:0;}
  .music-player:hover .mp-panel,.music-player.open .mp-panel{max-width:260px;opacity:1;padding:8px 16px 8px 12px;}
  .music-player:hover .mp-bubble,.music-player.open .mp-bubble{border-radius:50% 0 0 50%;border-right:none;box-shadow:none;}
  .mp-title{color:#00e5ff;font-family:'Crimson Text',serif;font-size:13px;white-space:nowrap;letter-spacing:.5px;min-width:80px;}
  .mp-controls{display:flex;gap:8px;align-items:center;}
  .mp-btn{background:none;border:1.5px solid rgba(0,229,255,.5);border-radius:50%;width:30px;height:30px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;padding:0;}
  .mp-btn:hover{background:rgba(0,229,255,.15);border-color:#00e5ff;}
  .mp-btn svg{fill:#00e5ff;width:14px;height:14px;}
  .mp-vol{-webkit-appearance:none;width:60px;height:3px;border-radius:2px;background:rgba(0,229,255,.25);outline:none;cursor:pointer;}
  .mp-vol::-webkit-slider-thumb{-webkit-appearance:none;width:10px;height:10px;border-radius:50%;background:#00e5ff;cursor:pointer;}
  @keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}
  .mp-bubble.playing svg.disc{animation:spin 3s linear infinite;}

  /* ‚îÄ‚îÄ INFO BAR ‚îÄ‚îÄ */
  .info-bar{background:linear-gradient(180deg,#2a1800,#1a0f00);border-top:1px solid rgba(184,134,11,.3);border-bottom:1px solid rgba(184,134,11,.3);padding:12px 30px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px;position:sticky;top:0;z-index:100;backdrop-filter:blur(10px);}
  .timer-box{display:flex;align-items:center;gap:10px;background:rgba(139,26,26,.2);border:1px solid rgba(139,26,26,.5);border-radius:4px;padding:8px 16px;}
  .timer-label{font-family:'Crimson Text',serif;color:var(--parchment-dark);font-size:14px;letter-spacing:1px;}
  .timer-display{font-family:'Playfair Display',serif;font-size:24px;font-weight:700;color:#4fc;letter-spacing:2px;min-width:70px;transition:color .3s;}
  .timer-display.caution{color:#ffa500!important;}
  .timer-display.warning{color:#ff4444!important;animation:pulse 1s infinite;}
  @keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}
  .score-display{font-family:'Playfair Display',serif;color:var(--gold-light);font-size:15px;letter-spacing:1px;}
  .progress-box{display:flex;align-items:center;gap:8px;color:var(--parchment-dark);font-size:13px;}
  .progress-bar-outer{width:120px;height:6px;background:rgba(255,255,255,.1);border-radius:3px;overflow:hidden;}
  .progress-bar-inner{height:100%;background:linear-gradient(90deg,var(--gold),var(--gold-bright));border-radius:3px;transition:width .3s ease;}

  /* ‚îÄ‚îÄ CONTAINER ‚îÄ‚îÄ */
  .container{max-width:900px;margin:0 auto;padding:30px 20px 60px;}
  .section-title{font-family:'Playfair Display',serif;font-size:20px;font-weight:700;color:var(--gold-bright);background:linear-gradient(180deg,#1a0f00,#0d0800);border:1px solid rgba(184,134,11,.4);border-left:4px solid var(--gold);padding:14px 20px;margin:30px 0 20px;letter-spacing:2px;text-transform:uppercase;position:relative;}
  .section-title::after{content:'';position:absolute;bottom:-1px;left:20px;right:20px;height:1px;background:linear-gradient(90deg,var(--gold),transparent);}
  .section-desc{color:var(--parchment-dark);font-style:italic;font-size:14px;background:rgba(245,236,215,.05);border:1px dashed rgba(184,134,11,.25);padding:10px 16px;margin-bottom:24px;line-height:1.6;}
  .shuffle-notice{text-align:center;color:rgba(184,134,11,.6);font-family:'Crimson Text',serif;font-size:13px;font-style:italic;margin-bottom:20px;}

  /* ‚îÄ‚îÄ QUESTION CARD ‚îÄ‚îÄ */
  .question-card{background:linear-gradient(135deg,#fdf8ef 0%,#f5ecd7 50%,#efe2c4 100%);border:1px solid var(--border);border-left:4px solid var(--gold);border-radius:2px;margin-bottom:20px;overflow:hidden;box-shadow:0 4px 20px rgba(0,0,0,.4),inset 0 1px 0 rgba(255,255,255,.5);position:relative;}
  .question-card::before{content:'';position:absolute;top:0;right:0;width:40px;height:40px;background:linear-gradient(225deg,rgba(184,134,11,.15) 0%,transparent 60%);}
  .question-header{background:linear-gradient(135deg,#1a0f00,#2a1800);padding:12px 20px;display:flex;align-items:flex-start;gap:12px;}
  .question-num{font-family:'Playfair Display',serif;font-size:13px;font-weight:700;color:var(--gold-bright);letter-spacing:1px;white-space:nowrap;padding-top:2px;}
  .question-text{font-family:'Cormorant Garamond',serif;font-size:17px;font-weight:600;color:var(--parchment);line-height:1.5;flex:1;}
  .source-box{background:linear-gradient(135deg,#fdf5e0,#f0e6c0);border:1px solid rgba(184,134,11,.5);border-left:4px solid var(--gold-light);margin:0;padding:20px 24px;position:relative;}
  .source-box::before{content:'‚ùù';position:absolute;top:10px;left:8px;font-size:36px;color:rgba(184,134,11,.2);line-height:1;font-family:Georgia,serif;}
  .source-text{font-family:'Cormorant Garamond',serif;font-size:15.5px;line-height:1.85;color:#2a1800;font-style:italic;padding-left:20px;}
  .source-cite{display:block;margin-top:10px;font-size:12.5px;color:var(--ink-light);font-style:normal;text-align:right;font-family:'Crimson Text',serif;opacity:.75;padding-left:20px;}
  .info-table{width:100%;border-collapse:collapse;font-family:'Cormorant Garamond',serif;font-size:15px;}
  .info-table th{background:rgba(26,15,0,.08);border:1px solid rgba(139,105,20,.4);padding:8px 14px;font-weight:700;color:#1a0f00;text-align:left;}
  .info-table td{border:1px solid rgba(139,105,20,.3);padding:7px 14px;color:#2a1800;}
  .info-table tr:nth-child(even) td{background:rgba(184,134,11,.05);}
  .options-grid{padding:16px 20px;display:flex;flex-direction:column;gap:8px;}
  .option-btn{display:flex;align-items:flex-start;gap:12px;padding:10px 16px;background:rgba(255,255,255,.6);border:1.5px solid rgba(139,105,20,.25);border-radius:3px;cursor:pointer;transition:all .18s;text-align:left;font-family:'Cormorant Garamond',serif;font-size:16px;color:var(--ink-light);line-height:1.5;width:100%;}
  .option-btn:hover:not(:disabled){background:rgba(184,134,11,.12);border-color:var(--gold);transform:translateX(3px);color:var(--ink);}
  .option-letter{min-width:26px;height:26px;border-radius:50%;background:linear-gradient(135deg,#1a0f00,#3d2b1a);color:var(--gold-light);display:flex;align-items:center;justify-content:center;font-family:'Playfair Display',serif;font-size:13px;font-weight:700;flex-shrink:0;margin-top:1px;transition:all .18s;}
  .option-btn.selected{background:rgba(184,134,11,.2);border-color:var(--gold);color:var(--ink);font-weight:600;}
  .option-btn.selected .option-letter{background:linear-gradient(135deg,var(--gold),var(--gold-bright));color:#1a0f00;}
  .option-btn.correct{background:rgba(26,74,26,.15)!important;border-color:var(--green-light)!important;color:var(--green)!important;}
  .option-btn.correct .option-letter{background:linear-gradient(135deg,var(--green),var(--green-light))!important;color:white!important;}
  .option-btn.wrong{background:rgba(139,26,26,.12)!important;border-color:#c0392b!important;color:var(--red)!important;}
  .option-btn.wrong .option-letter{background:linear-gradient(135deg,#8b1a1a,#c0392b)!important;color:white!important;}
  .answer-feedback{padding:8px 20px 14px;font-family:'Crimson Text',serif;font-size:14px;display:none;}
  .answer-feedback.show{display:block;}
  .feedback-correct{color:var(--green);display:flex;align-items:center;gap:6px;}
  .feedback-wrong{color:var(--red);display:flex;align-items:center;gap:6px;}

  /* Part 2 sub */
  .sub-q{border-top:1px solid rgba(139,105,20,.2);padding:14px 20px 0;}
  .sub-q:last-child{padding-bottom:16px;}
  .sub-q-text{font-family:'Cormorant Garamond',serif;font-size:16px;color:var(--ink);margin-bottom:10px;font-weight:600;line-height:1.5;}
  .sub-q-label{display:inline-block;background:linear-gradient(135deg,#1a0f00,#3d2b1a);color:var(--gold-light);font-family:'Playfair Display',serif;font-size:13px;padding:2px 8px;border-radius:2px;margin-right:8px;}
  .tf-options{display:flex;gap:10px;flex-wrap:wrap;}
  .tf-btn{padding:9px 24px;border:1.5px solid rgba(139,105,20,.3);border-radius:3px;background:rgba(255,255,255,.6);font-family:'Cormorant Garamond',serif;font-size:16px;font-weight:600;cursor:pointer;transition:all .18s;color:var(--ink-light);}
  .tf-btn:hover:not(:disabled){background:rgba(184,134,11,.12);border-color:var(--gold);}
  .tf-btn.sel-true{background:rgba(26,74,26,.12);border-color:var(--green-light);color:var(--green);}
  .tf-btn.sel-false{background:rgba(139,26,26,.1);border-color:#c0392b;color:var(--red);}
  .tf-btn.tf-correct{background:rgba(26,74,26,.18)!important;border-color:var(--green-light)!important;color:var(--green)!important;font-weight:700;}
  .tf-btn.tf-wrong{background:rgba(139,26,26,.15)!important;border-color:#c0392b!important;color:var(--red)!important;}

  /* Actions */
  .action-area{text-align:center;padding:40px 20px;}
  .submit-btn{font-family:'Playfair Display',serif;font-size:18px;font-weight:700;letter-spacing:3px;text-transform:uppercase;color:#1a0f00;background:linear-gradient(135deg,var(--gold),var(--gold-bright),var(--gold));border:none;padding:18px 60px;cursor:pointer;position:relative;overflow:hidden;transition:all .3s;box-shadow:0 4px 20px rgba(184,134,11,.4);}
  .submit-btn::before{content:'';position:absolute;inset:2px;border:1px solid rgba(255,255,255,.3);pointer-events:none;}
  .submit-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(184,134,11,.6);}
  .restart-btn{background:linear-gradient(135deg,#1a0f00,#3d2b1a);color:var(--gold-light);border:2px solid var(--gold);font-family:'Playfair Display',serif;font-size:16px;font-weight:700;letter-spacing:2px;padding:14px 40px;cursor:pointer;margin-top:20px;transition:all .3s;text-transform:uppercase;display:none;}
  .restart-btn:hover{background:linear-gradient(135deg,var(--gold),var(--gold-bright));color:#1a0f00;}

  /* Modal */
  .modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.85);z-index:1000;justify-content:center;align-items:center;backdrop-filter:blur(6px);}
  .modal-overlay.show{display:flex;}
  .modal{background:linear-gradient(135deg,#fdf8ef,#f5ecd7,#efe2c4);border:2px solid var(--gold);max-width:580px;width:90%;max-height:85vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,.7),inset 0 1px 0 rgba(255,255,255,.5);animation:modalIn .4s ease;}
  @keyframes modalIn{from{transform:scale(.9) translateY(-20px);opacity:0}to{transform:scale(1) translateY(0);opacity:1}}
  .modal-header{background:linear-gradient(135deg,#1a0f00,#2a1800);padding:24px 28px;text-align:center;border-bottom:2px solid var(--gold);}
  .modal-title{font-family:'Playfair Display',serif;font-size:24px;font-weight:900;color:var(--gold-bright);letter-spacing:3px;text-transform:uppercase;}
  .modal-body{padding:28px;}
  .score-big{text-align:center;margin:10px 0 24px;}
  .score-number{font-family:'Playfair Display',serif;font-size:64px;font-weight:900;color:var(--gold);text-shadow:0 0 20px rgba(184,134,11,.4);line-height:1;}
  .score-total{font-family:'Cormorant Garamond',serif;font-size:20px;color:var(--ink-light);margin-top:4px;}
  .score-grade{display:inline-block;font-family:'Playfair Display',serif;font-size:28px;font-weight:700;padding:8px 24px;margin-top:12px;border:2px solid;letter-spacing:2px;}
  .grade-a{border-color:var(--green);color:var(--green);background:rgba(26,74,26,.08);}
  .grade-b{border-color:var(--gold);color:var(--gold);background:rgba(184,134,11,.08);}
  .grade-c{border-color:#d4820a;color:#d4820a;background:rgba(212,130,10,.08);}
  .grade-d{border-color:var(--red);color:var(--red);background:rgba(139,26,26,.08);}
  .score-breakdown{background:rgba(26,15,0,.04);border:1px solid rgba(139,105,20,.3);padding:16px 20px;margin-top:16px;}
  .breakdown-title{font-family:'Playfair Display',serif;font-size:14px;letter-spacing:1px;text-transform:uppercase;color:var(--ink-light);margin-bottom:12px;}
  .breakdown-row{display:flex;justify-content:space-between;font-family:'Cormorant Garamond',serif;font-size:15px;padding:4px 0;border-bottom:1px dotted rgba(139,105,20,.2);color:var(--ink);}
  .breakdown-row:last-child{border-bottom:none;}
  .btn-group{display:flex;gap:12px;justify-content:center;margin-top:24px;flex-wrap:wrap;}
  .modal-btn{font-family:'Playfair Display',serif;font-size:14px;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:12px 28px;border:2px solid;cursor:pointer;transition:all .2s;}
  .modal-btn-primary{background:linear-gradient(135deg,var(--gold),var(--gold-bright));border-color:var(--gold);color:#1a0f00;}
  .modal-btn-primary:hover{transform:translateY(-1px);}
  .modal-btn-secondary{background:transparent;border-color:var(--ink-light);color:var(--ink-light);}
  .modal-btn-secondary:hover{background:rgba(26,15,0,.08);}
  .ornament{color:var(--gold);opacity:.5;font-size:20px;}
  @media(max-width:600px){.info-bar{flex-direction:column;padding:10px 16px;gap:6px}.progress-box{display:none}.header{padding:28px 16px 36px}}

  /* Reading passage group border */
  .passage-group{border:1px solid rgba(139,105,20,.4);margin-bottom:4px;background:linear-gradient(135deg,#fdf8ef,#f5ecd7);}
  .passage-label{background:linear-gradient(135deg,#1a0f00,#2a1800);padding:10px 20px;font-family:'Playfair Display',serif;font-size:13px;color:var(--gold-light);letter-spacing:1px;}
</style>
</head>
<body>

<!-- MUSIC PLAYER -->
<div class="music-player" id="musicPlayer">
  <div class="mp-bubble" id="mpBubble" onclick="togglePlay()" title="Nh·∫°c n·ªÅn">
    <!-- disc icon when playing, note icon when paused -->
    <svg viewBox="0 0 24 24" id="mpIcon">
      <path d="M12 3v10.55A4 4 0 1 0 14 17V7h4V3h-6z"/>
    </svg>
  </div>
  <div class="mp-panel" id="mpPanel">
    <span class="mp-title" id="mpTitle">Nh·∫°c n·ªÅn</span>
    <div class="mp-controls">
      <button class="mp-btn" onclick="togglePlay()" id="mpPlayBtn" title="Play/Pause">
        <svg viewBox="0 0 24 24" id="mpPlayIcon"><path d="M8 5v14l11-7z"/></svg>
      </button>
      <input type="range" class="mp-vol" id="mpVol" min="0" max="1" step="0.05" value="0.5" oninput="setVol(this.value)" title="√Çm l∆∞·ª£ng">
    </div>
  </div>
</div>

<!-- YouTube iframe (hidden) -->
<div id="ytContainer" style="position:fixed;bottom:-200px;left:-200px;width:1px;height:1px;overflow:hidden;pointer-events:none;">
  <div id="ytPlayer"></div>
</div>

<div class="top-border"></div>
<header class="header">
  <div class="header-ornament">‚ú¶ ‚ú¶ ‚ú¶</div>
  <h1>B√ÄI KI·ªÇM TRA L·ªäCH S·ª¨</h1>
  <h2>ƒê·ªÅ s·ªë 38 ‚Äì L·ªãch S·ª≠ Vi·ªát Nam &amp; Th·∫ø Gi·ªõi</h2>
  <div class="header-divider"></div>
  <div style="color:var(--parchment-dark);font-size:14px;font-style:italic;opacity:.7;">Th·ªùi gian: 45 ph√∫t &nbsp;|&nbsp; T·ªïng ƒëi·ªÉm: 10.0</div>
</header>

<div class="info-bar">
  <div class="timer-box">
    <span class="timer-label">‚è± Th·ªùi gian c√≤n l·∫°i:</span>
    <span class="timer-display" id="timerDisplay">45:00</span>
  </div>
  <div class="score-display" id="liveScore">ƒê√£ tr·∫£ l·ªùi: 0 / 40 c√¢u</div>
  <div class="progress-box">
    <span>Ti·∫øn ƒë·ªô:</span>
    <div class="progress-bar-outer"><div class="progress-bar-inner" id="progressBar" style="width:0%"></div></div>
    <span id="progressPct">0%</span>
  </div>
</div>

<div class="container" id="quizContainer"></div>

<!-- YouTube IFrame API -->
<script src="https://www.youtube.com/iframe_api"></script>
<script>
// ============================================================
// YOUTUBE PLAYER
// ============================================================
let ytPlayer = null;
let ytReady = false;
let isPlaying = false;
let pendingPlay = false;

function onYouTubeIframeAPIReady() {
  ytPlayer = new YT.Player('ytPlayer', {
    height: '1', width: '1',
    videoId: 'QlhCP4s_x1o',
    playerVars: { autoplay: 0, loop: 1, playlist: 'QlhCP4s_x1o', controls: 0, disablekb: 1 },
    events: {
      onReady: function(e) {
        ytReady = true;
        e.target.setVolume(50);
        if (pendingPlay) { e.target.playVideo(); pendingPlay = false; }
      },
      onStateChange: function(e) {
        if (e.data === YT.PlayerState.PLAYING) {
          isPlaying = true;
          updateMpUI();
        } else if (e.data === YT.PlayerState.PAUSED || e.data === YT.PlayerState.ENDED) {
          isPlaying = false;
          updateMpUI();
        }
      }
    }
  });
}

function togglePlay() {
  if (!ytReady) { pendingPlay = true; return; }
  if (isPlaying) {
    ytPlayer.pauseVideo();
  } else {
    ytPlayer.playVideo();
    document.getElementById('musicPlayer').classList.add('open');
  }
}

function setVol(v) {
  if (ytReady) ytPlayer.setVolume(Math.round(v * 100));
}

function updateMpUI() {
  const icon = document.getElementById('mpPlayIcon');
  const bubble = document.getElementById('mpBubble');
  const mpIcon = document.getElementById('mpIcon');
  if (isPlaying) {
    icon.innerHTML = '<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>';
    bubble.title = 'T·∫°m d·ª´ng';
    mpIcon.style.animation = 'spin 3s linear infinite';
    document.getElementById('mpTitle').textContent = '‚ô™ ƒêang ph√°t...';
  } else {
    icon.innerHTML = '<path d="M8 5v14l11-7z"/>';
    bubble.title = 'Ph√°t nh·∫°c';
    mpIcon.style.animation = '';
    document.getElementById('mpTitle').textContent = 'Nh·∫°c n·ªÅn';
  }
}

// hover open panel on mobile tap
document.getElementById('musicPlayer').addEventListener('click', function(e) {
  if (!e.target.closest('.mp-btn') && !e.target.closest('.mp-vol')) {
    this.classList.toggle('open');
  }
});

// ============================================================
// DATA
// ============================================================
const PART1_ORIG = [
  {id:'p1_1',q:'N·ªôi dung n√†o sau ƒë√¢y l√† ƒë√∫ng nguy√™n nh√¢n vua L√™ Th√°nh T√¥ng ti·∫øn h√†nh cu·ªôc c·∫£i c√°ch l·ªõn ·ªü th·∫ø k·ª∑ XV?',opts:['Th·ªëng nh·∫•t ƒë·∫•t n∆∞·ªõc v·ªÅ m·∫∑t l√£nh th·ªï.','TƒÉng c∆∞·ªùng quy·ªÅn l·ª±c cho ho√†ng ƒë·∫ø.','Gi·∫£m b·ªõt s·ª± ph·ª• thu·ªôc v√†o nh√† Minh.','ƒê·ªÅ cao tinh th·∫ßn l√†m ch·ªß c·ªßa nh√¢n d√¢n.'],ans:'B'},
  {id:'p1_2',q:'N·ªôi dung n√†o sau ƒë√¢y gi·∫£i th√≠ch ƒë√∫ng gi√° tr·ªã nh·ªØng t·∫≠p b·∫£n ƒë·ªì c·ªßa c√°c tri·ªÅu ƒë·∫°i phong ki·∫øn ƒë·ªëi v·ªõi c√¥ng cu·ªôc b·∫£o v·ªá ch·ªß quy·ªÅn bi·ªÉn ƒë·∫£o c·ªßa Vi·ªát Nam hi·ªán nay?',opts:['B·∫±ng ch·ª©ng kh·∫≥ng ƒë·ªãnh v·ªØng ch·∫Øc ch·ªß quy·ªÅn c·ªßa Vi·ªát Nam.','B·∫±ng ch·ª©ng x√°c th·ª±c ƒë·ªÉ Vi·ªát Nam kh·ªüi ki·ªán ra t√≤a √°n qu·ªëc t·∫ø.','C√°c c√¥ng tr√¨nh c√≥ gi√° tr·ªã l·ªõn v·ªÅ kinh t·∫ø, khoa h·ªçc v√† vƒÉn h√≥a.','C∆° s·ªü ƒë·ªÉ Li√™n h·ª£p qu·ªëc trao tr·∫£ c√°c qu·∫ßn ƒë·∫£o cho Vi·ªát Nam.'],ans:'A'},
  {id:'p1_3',q:'N·ªôi dung n√†o sau ƒë√¢y n·∫±m trong cu·ªôc c·∫£i c√°ch c·ªßa vua Minh M·∫°ng ƒë·∫ßu th·∫ø k·ª∑ XIX?',opts:['B√£i b·ªè c√°c ch·ª©c v·ª• nh∆∞ T·ªÉ t∆∞·ªõng, ƒê·∫°i h√†nh khi·ªÉn.','Chia c·∫£ n∆∞·ªõc th√†nh c√°c ph·ªß v√† 13 ƒë·∫°o Th·ª´a tuy√™n.','Chia c·∫£ n∆∞·ªõc th√†nh 30 t·ªânh v√† m·ªôt ph·ªß Th·ª´a Thi√™n.','Thi h√†nh ch√≠nh s√°ch qu√¢n ƒëi·ªÅn v√† ch·∫ø ƒë·ªô l·ªôc ƒëi·ªÅn.'],ans:'C'},
  {id:'p1_4',q:'N·ªôi dung n√†o sau ƒë√¢y ph·∫£n √°nh ƒë√∫ng ƒë·∫∑c ƒëi·ªÉm c·ªßa qu√° tr√¨nh th·ª±c thi ch·ªß quy·ªÅn ƒë·ªëi v·ªõi Ho√†ng Sa, Tr∆∞·ªùng Sa c·ªßa nh√† Nguy·ªÖn ·ªü ƒë·∫ßu th·∫ø k·ª∑ XIX?',opts:['Th·ª±c hi·ªán m·ªôt c√°ch quy c·ªß, ch·∫∑t ch·∫Ω v√† li√™n t·ª•c.','Ti·∫øn h√†nh kh√¥ng li√™n t·ª•c, b·ªã nh√† Thanh tranh ch·∫•p.','Ch·ªß y·∫øu th·ª±c hi·ªán d∆∞·ªõi th·ªùi vua Thi·ªáu Tr·ªã, T·ª± ƒê·ª©c.','Ph√°p ƒë·∫°i di·ªán nh√† Nguy·ªÖn k√Ω nhi·ªÅu c√¥ng ∆∞·ªõc bi·ªÉn.'],ans:'A'},
  {id:'p1_5',q:'C∆° quan n√†o sau ƒë√¢y c·ªßa Li√™n h·ª£p qu·ªëc l√† n∆°i t·∫≠p h·ª£p ƒë·∫°i di·ªán c·ªßa t·∫•t c·∫£ c√°c n∆∞·ªõc th√†nh vi√™n?',opts:['ƒê·∫°i h·ªôi ƒë·ªìng.','Ban th∆∞ k√Ω.','H·ªôi ƒë·ªìng b·∫£o an.','To√† √°n qu·ªëc t·∫ø.'],ans:'A'},
  {id:'p1_6',q:'N·ªôi dung n√†o sau ƒë√¢y l√† th·ªèa thu·∫≠n c·ªßa M·ªπ - Anh ‚Äì Li√™n X√¥ trong H·ªôi ngh·ªã Ianta (2/1945)?',opts:['Ch·∫•m d·ª©t t√¨nh tr·∫°ng n·ªôi chi·∫øn Trung Qu·ªëc.','Th·ªß ti√™u ch·ªß nghƒ©a ph√¢n bi·ªát v·ªÅ ch·ªßng t·ªôc.','ƒê·ª©c tr·ªü th√†nh qu·ªëc gia th·ªëng nh·∫•t, d√¢n ch·ªß.','C·∫ßn ti√™u di·ªát t·∫≠n g·ªëc ch·ªß nghƒ©a ph√°t x√≠t ƒê·ª©c'],ans:'D'},
  {id:'p1_7',q:'N·ªôi dung n√†o sau ƒë√¢y ph·∫£n √°nh ƒë√∫ng v·ªÅ nguy√™n t·∫Øc ho·∫°t ƒë·ªông c·ªßa C·ªông ƒë·ªìng ch√≠nh tr·ªã - an ninh (APSC) ASEAN?',opts:['T√¥n tr·ªçng quy·ªÅn con ng∆∞·ªùi.','Tu√¢n th·ªß lu·∫≠t ph√°p qu·ªëc t·∫ø.','Kh√¥ng d√πng v≈© kh√≠ h·∫°t nh√¢n.','T·∫°o th√†nh li√™n minh qu√¢n s·ª±.'],ans:'B'},
  {id:'p1_8',q:'N·ªôi dung n√†o sau ƒë√¢y ph·∫£n √°nh ƒë√∫ng t√≠nh ch·∫•t c·ªßa C·ªông ƒë·ªìng ch√≠nh tr·ªã - an ninh (APSC) ASEAN?',opts:['Phi qu√¢n s·ª±.','Phi h·∫°t nh√¢n.','Khu v·ª±c h√≥a.','To√†n c·∫ßu h√≥a.'],ans:'A'},
  {id:'p1_9',q:'N·ªôi dung n√†o sau ƒë√¢y l√† nh√¢n t·ªë kh√°ch quan d·∫´n ƒë·∫øn s·ª± th√†nh c√¥ng c·ªßa c√¥ng cu·ªôc ƒê·ªïi m·ªõi ƒë·∫•t n∆∞·ªõc c·ªßa Vi·ªát Nam t·ª´ nƒÉm 1986 ƒë·∫øn nay?',opts:['B√†i h·ªçc t·ª´ Li√™n X√¥ v√† Trung Qu·ªëc.','Vi·ªán tr·ª£ c·∫ßn thi·∫øt t·ª´ Li√™n H·ª£p qu·ªëc.','Truy·ªÅn th·ªëng ƒëo√†n k·∫øt c·ªßa d√¢n t·ªôc.','ƒê∆∞·ªùng l·ªëi l√£nh ƒë·∫°o ƒë√∫ng c·ªßa ƒê·∫£ng.'],ans:'A'},
  {id:'p1_10',q:'N·ªôi dung n√†o sau ƒë√¢y gi·∫£i th√≠ch ƒë√∫ng quan ƒëi·ªÉm "ƒê·ªïi m·ªõi to√†n di·ªán v√† ƒë·ªìng b·ªô" c·ªßa ƒê·∫£ng C·ªông s·∫£n Vi·ªát Nam ƒë∆∞·ª£c th√¥ng qua t·∫°i ƒê·∫°i h·ªôi ƒë·∫°i bi·ªÉu to√†n qu·ªëc l·∫ßn th·ª© VI (12 - 1986)?',opts:['ƒê·ªïi m·ªõi tr√™n t·∫•t c·∫£ c√°c lƒ©nh v·ª±c v√† ƒë·ªìng th·ªùi.','Ki√™n ƒë·ªãnh m·ª•c ti√™u x√¢y d·ª±ng ch·ªß nghƒ©a x√£ h·ªôi.','Thay ƒë·ªïi ho√†n to√†n m·ª•c ti√™u ch·ªß nghƒ©a x√£ h·ªôi.','X√≥a b·ªè ho√†n to√†n n·ªÅn kinh t·∫ø quan li√™u bao c·∫•p.'],ans:'A'},
  {id:'p1_11',q:'N·ªôi dung n√†o sau ƒë√¢y l√† ƒëi·ªÉm t∆∞∆°ng ƒë·ªìng v·ªÅ th·∫Øng l·ª£i tr√™n m·∫∑t tr·∫≠n ngo·∫°i giao c·ªßa Vi·ªát Nam qua hai cu·ªôc kh√°ng chi·∫øn ch·ªëng Ph√°p (1945-1954) v√† Mƒ© (1954-1975)?',opts:['Bu·ªôc ƒë·ªëi ph∆∞∆°ng ph·∫£i c√¥ng nh·∫≠n quy·ªÅn d√¢n t·ªôc c∆° b·∫£n c·ªßa Vi·ªát Nam.','T·ª´ quan h·ªá ƒë·ªëi ƒë·∫ßu chuy·ªÉn sang h·ª£p t√°c ƒë·ªëi tho·∫°i ƒë√¥i b√™n c√πng c√≥ l·ª£i.','ƒê·ªëi ph∆∞∆°ng ph·∫£i b·ªìi th∆∞·ªùng chi·∫øn tranh theo c√°c ƒëi·ªÅu kho·∫£n ƒë·∫£ k√≠ k·∫øt.','Bu·ªôc ƒë·ªëi ph∆∞∆°ng ph·∫£i th·ª´a nh·∫≠n n·ªÅn ƒë·ªôc l·∫≠p c·ªßa ba n∆∞·ªõc ƒê√¥ng D∆∞∆°ng.'],ans:'A'},
  {id:'p1_12',q:'Th·∫Øng l·ª£i tr√™n m·∫∑t tr·∫≠n ngo·∫°i giao c·ªßa Vi·ªát Nam ·ªü Gi∆°-ne-v∆° (1954) v√† Pa-ri (1973) c√≥ ƒëi·ªÉm t∆∞∆°ng ƒë·ªìng n√†o sau ƒë√¢y?',opts:['ƒê·ªÅu do th·∫Øng l·ª£i qu√¢n s·ª± quy·∫øt ƒë·ªãnh.','ƒê·ªÅu ti·∫øn h√†nh ƒë√†m ph√°n g·ªìm b·ªën b√™n.','Di·ªÖn ra khi chi·∫øn tranh ƒë√£ k·∫øt th√∫c.','Di·ªÖn ra khi chi·∫øn tranh ch∆∞a k·∫øt th√∫c.'],ans:'A'},
  {id:'p1_13',q:'N·ªôi dung n√†o sau ƒë√¢y ph·∫£n √°nh ƒë√∫ng ph∆∞∆°ng ch√¢m ch·ªâ ƒë·∫°o "v·ª´a ƒë√°nh, v·ª´a ƒë√†m" c·ªßa ƒê·∫£ng Lao ƒë·ªông Vi·ªát Nam trong cu·ªôc kh√°ng chi·∫øn ch·ªëng Mƒ© (1954-1975)?',opts:['K·∫øt h·ª£p ƒë·∫•u tranh qu√¢n s·ª± v·ªõi ƒë·∫•u tranh ngo·∫°i giao.','K·∫øt h·ª£p ƒë·∫•u tranh ch√≠nh tr·ªã v·ªõi h·ª£p t√°c, th∆∞∆°ng l∆∞∆°ng.','K·∫øt h·ª£p ƒë·∫•u tranh ch√≠nh tr·ªã v·ªõi ƒë·∫•u tranh ngo·∫°i giao.','K·∫øt h·ª£p ƒë·∫•u tranh ch√≠nh tr·ªã v·ªõi ƒë·∫•u tranh ngo·∫°i giao.'],ans:'A'},
  {id:'p1_14',q:'Ch·ªß t·ªãch H·ªì Ch√≠ Minh ƒë√£ ch·ªâ ra th·∫ø l·ª±c n√†o sau ƒë√¢y ƒë·ª©ng sau tr·ª£ gi√∫p cho Ph√°p quay tr·ªü l·∫°i x√¢m l∆∞·ª£c Vi·ªát Nam sau nƒÉm 1945?',opts:['Anh, M·ªπ.','ƒê·ª©c, √ù.','Th√°i Lan.','Nh·∫≠t B·∫£n.'],ans:'A'},
  {id:'p1_15',q:'Ch·ªß t·ªãch H·ªì Ch√≠ Minh k√™u g·ªçi nh√¢n d√¢n Vi·ªát Nam ph·∫£i ra s·ª©c ·ªßng h·ªô phong tr√†o h√≤a b√¨nh th·∫ø gi·ªõi v√¨ nguy√™n nh√¢n n√†o sau ƒë√¢y?',opts:['Th√∫c ƒë·∫©y nhanh qu√° tr√¨nh c√°c n∆∞·ªõc x√£ h·ªôi ch·ªß nghƒ©a ƒê√¥ng √Çu c√¥ng nh·∫≠n Vi·ªát Nam.','Phong tr√†o ph·∫£n ƒë·ªëi cu·ªôc chi·∫øn tranh x√¢m l∆∞·ª£c Vi·ªát Nam c·ªßa Ph√°p di·ªÖn ra m·∫°nh m·∫Ω.','Cu·ªôc kh√°ng chi·∫øn ƒëang g·∫∑p kh√≥ khƒÉn l·ªõn n√™n c·∫ßn tranh th·ªß s·ª± gi√∫p ƒë·ª° t·ª´ b√™n ngo√†i.','Phong tr√†o ƒë·∫•u tranh gi·∫£i ph√≥ng d√¢n t·ªôc tr√™n th·∫ø gi·ªõi ƒëang ph√°t tri·ªÉn r·∫•t nhanh ch√≥ng.'],ans:'B'},
  {id:'p1_16',q:'N·ªôi dung n√†o sau ƒë√¢y ph·∫£n √°nh ƒë√∫ng v·ªÅ vai tr√≤ c·ªßa Nguy·ªÖn √Åi Qu·ªëc trong vi·ªác th√†nh l·∫≠p ƒê·∫£ng C·ªông s·∫£n Vi·ªát Nam (1930)?',opts:['Tri·ªáu t·∫≠p v√† ch·ªß tr√¨ H·ªôi ngh·ªã th√†nh l·∫≠p ƒê·∫£ng C·ªông s·∫£n Vi·ªát Nam.','Tri·ªáu t·∫≠p h·ªôi ngh·ªã th·ªëng nh·∫•t c√°c t·ªï ch·ª©c c·ªông s·∫£n t·∫°i Cao B·∫±ng.','So·∫°n th·∫£o ƒê∆∞·ªùng K√°ch m·ªánh- C∆∞∆°ng lƒ©nh c·ªßa ƒê·∫£ng C·ªông s·∫£n Vi·ªát Nam.','Tri·ªáu t·∫≠p v√† ch·ªß tr√¨ ƒê·∫°i h·ªôi th√†nh l·∫≠p ƒê·∫£ng t·∫°i Ma Cao (Trung Qu·ªëc).'],ans:'A'},
  {id:'p1_17',q:'Chi·∫øn th·∫Øng n√†o c·ªßa qu√¢n v√† d√¢n Vi·ªát Nam ƒë∆∞·ª£c xem l√† d·∫•u m·ªëc ghi nh·∫≠n nhi·ªám v·ª• "ƒë√°nh cho ng·ª•y nh√†o" ƒë√£ ho√†n th√†nh?',opts:['Hi·ªáp ƒë·ªãnh Paris ch√≠nh th·ª©c k√Ω k·∫øt.','Chi·∫øn d·ªãch H·ªì Ch√≠ Minh to√†n th·∫Øng.','M·ªπ tuy√™n b·ªë phi M·ªπ h√≥a chi·∫øn tranh.','K·ª≥ h·ªçp ƒë·∫ßu ti√™n c·ªßa Qu·ªëc h·ªôi kh√≥a VI.'],ans:'B'},
  {id:'p1_18',q:'N·ªôi dung n√†o sau ƒë√¢y l√† √Ω nghƒ©a c·ªßa chi·∫øn d·ªãch T√¢y Nguy√™n (3-1975) trong cu·ªôc kh√°ng chi·∫øn ch·ªëng M·ªπ c·ª©u n∆∞·ªõc?',opts:['Th√∫c ƒë·∫©y th·ªùi c∆° chi·∫øn l∆∞·ª£c ƒë·∫øn nhanh ƒë·ªÉ gi·∫£i ph√≥ng mi·ªÅn Nam.','Chi·∫øn th·∫Øng T√¢y Nguy√™n t·∫°o ƒëi·ªÅu ki·ªán ƒë·ªÉ gi·∫£i ph√≥ng Campuchia.','L√† ƒë√≤n quy·∫øt chi·∫øn chi·∫øn l∆∞·ª£c k·∫øt th√∫c chi·∫øn tranh ƒê√¥ng D∆∞∆°ng.','ƒê√£ m·ªü toang c√°nh c·ª≠a ph√≤ng th·ªß c·ª≠a ng√µ ph√≠a T√¢y c·ªßa S√†i G√≤n.'],ans:'A'},
  // Reading 19-21 share passage
  {id:'p1_19',q:'Sau Chi·∫øn tranh th·∫ø gi·ªõi th·ª© hai, c√°c n∆∞·ªõc M·ªπ Latinh ƒë·∫•u tranh ch·ªëng l·∫°i ƒë·ªëi t∆∞·ª£ng n√†o sau ƒë√¢y?',passage:'cuba',opts:['Ch·ªß nghƒ©a th·ª±c d√¢n ki·ªÉu c≈©.','Ch·ªß nghƒ©a th·ª±c d√¢n ki·ªÉu m·ªõi.','Ch·ªß nghƒ©a ph√¢n bi·ªát ch·ªßng t·ªôc.','Ch·ªß nghƒ©a qu√¢n phi·ªát ph√°t x√≠t.'],ans:'B'},
  {id:'p1_20',q:'N·ªôi dung n√†o sau ƒë√¢y ph·∫£n √°nh ƒë√∫ng nguy√™n nh√¢n Ch·ªß t·ªãch H·ªì Ch√≠ Minh l√Ω gi·∫£i v·ªÅ ngu·ªìn g·ªëc nh·ªØng m√¢u thu·∫´n c·ªßa M·ªπ ƒë·ªëi v·ªõi khu v·ª±c M·ªπ Latinh?',passage:'cuba',opts:['M·ªπ Latinh ƒë·ªìng minh chi·∫øn l∆∞·ª£c c·ªßa M·ªπ trong chi·∫øn tranh th·∫ø gi·ªõi.','Ch√≠nh s√°ch th·ª±c d√¢n c·ªßa M·ªπ ƒë·ªÉ l·∫°i h·∫≠u qu·∫£ n·∫∑ng n·ªÅ ƒë·ªëi v·ªõi M·ªπ Latinh.','M·ªπ t√¨m c√°ch trao tr·∫£ ƒë·ªôc l·∫≠p d√¢n t·ªôc cho h·∫ßu h·∫øt c√°c n∆∞·ªõc ·ªü khu v·ª±c.','C√°c n∆∞·ªõc ·ªü M·ªπ Latinh ƒë·ªÅu ph√°t tri·ªÉn theo con ƒë∆∞·ªùng ch·ªß nghƒ©a x√£ h·ªôi.'],ans:'B'},
  {id:'p1_21',q:'Nh·∫≠n ƒë·ªãnh n√†o sau ƒë√¢y l√† ƒë√∫ng v·ªÅ ƒëi·ªÉm t∆∞∆°ng ƒë·ªìng gi·ªØa phong tr√†o gi·∫£i ph√≥ng d√¢n t·ªôc ·ªü M·ªπ Latinh v√† Vi·ªát Nam sau Chi·∫øn tranh th·∫ø gi·ªõi th·ª© hai?',passage:'cuba',opts:['ƒê·ªÅu ch·ªëng l·∫°i ch·ªß nghƒ©a th·ª±c d√¢n c≈© v√† m·ªõi d∆∞·ªõi nhi·ªÅu h√¨nh th·ª©c.','ƒê·ªÅu ch·ªëng l·∫°i ƒë·ªëi t∆∞·ª£ng m·∫°nh nh·∫•t c·ªßa l·ª±c l∆∞·ª£ng ph·∫£n c√°ch m·∫°ng.','ƒê·ªÅu l√† c√°c cu·ªôc chi·∫øn tranh gi·∫£i ph√≥ng, ch·∫•m d·ª©t chia c·∫Øt ƒë·∫•t n∆∞·ªõc.','ƒê·ªÅu nh·∫≠n ƒë∆∞·ª£c s·ª± ·ªßng h·ªô, gi√∫p ƒë·ª° to l·ªõn c·ªßa Li√™n X√¥, Trung Qu·ªëc.'],ans:'A'},
  {id:'p1_22',q:'T·ª´ c√°c cu·ªôc chi·∫øn tranh c·ª•c b·ªô Chi·∫øn tranh l·∫°nh, b√†i h·ªçc m√† Vi·ªát Nam c√≥ th·ªÉ r√∫t ra cho ch√≠nh s√°ch ƒë·ªëi ngo·∫°i hi·ªán nay l√†',opts:['kh√¥ng li√™n minh li√™n k·∫øt v·ªõi c√°c n∆∞·ªõc ch√¢u √Çu.','m·ªü c·ª≠a thu h√∫t ƒë·∫ßu t∆∞, khoa h·ªçc - k·ªπ thu·∫≠t, v·ªën.','th·ª±c hi·ªán ƒë∆∞·ªùng l·ªìi ƒë·ªëi ngo·∫°i ƒë·ªôc l·∫≠p, t·ª± ch·ªß.','tham gia nhi·ªÅu t·ªï ch·ª©c qu·ªëc t·∫ø v√† khu v·ª±c.'],ans:'C'},
  {id:'p1_23',q:'Nh·∫≠n ƒë·ªãnh n√†o sau ƒë√¢y l√† ƒë√∫ng v·ªÅ quan ƒëi·ªÉm c·ªßa Ch·ªß t·ªãch H·ªì Ch√≠ Minh v·ªÅ ƒëo√†n k·∫øt qu·ªëc t·∫ø trong qu√° tr√¨nh l√£nh ƒë·∫°o c√°ch m·∫°ng Vi·ªát Nam 1945-1969?',opts:['Th·ª±c hi·ªán m·ªôt c√°ch nh·∫•t qu√°n, xuy√™n su·ªët.','ƒê·∫∑t tr·ªçng t√¢m v√†o quan h·ªá v·ªõi Trung Qu·ªëc.','ƒêo√†n k·∫øt v·ªõi c√°c n∆∞·ªõc c√πng th·ªÉ ch·∫ø ch√≠nh tr·ªã.','L·∫•y ƒëo√†n k·∫øt qu·ªëc t·∫ø l√†m n·ªÅn t·∫£ng kh√°ng chi·∫øn.'],ans:'A'},
  {id:'p1_24',q:'S·ª± th√†nh l·∫≠p v√† ph√°t tri·ªÉn c·ªßa Li√™n h·ª£p qu·ªëc c√πng s·ª± t·ªìn t·∫°i c·ªßa c√°c tr·∫≠t t·ª± th·∫ø gi·ªõi sau Chi·∫øn tranh th·∫ø gi·ªõi th·ª© hai ch·ª©ng t·ªè',opts:['t√¨nh h√¨nh th·∫ø gi·ªõi li√™n t·ª•c cƒÉng th·∫≥ng do t√°c ƒë·ªông t·ª´ Chi·∫øn tranh l·∫°nh.','c√°c c∆∞·ªùng qu·ªëc t∆∞ b·∫£n ch·ªß nghƒ©a chi ph·ªëi ho√†n to√†n quan h·ªá qu·ªëc t·∫ø.','vai tr√≤ c·ªßa c√°c c∆∞·ªùng qu·ªëc trong s·ª± ph√°t tri·ªÉn c·ªßa quan h·ªá qu·ªëc t·∫ø.','c√≥ s·ª± ƒë·ªëi l·∫≠p gay g·∫Øt tr√™n m·ªçi lƒ©nh v·ª±c gi·ªØa hai h·ªá th·ªëng x√£ h·ªôi ƒë·ªëi l·∫≠p.'],ans:'C'},
];

const PASSAGE_CUBA = `"V√¨ sao ƒë·∫ø qu·ªëc M·ªπ cƒÉm gh√©t Cu Ba ƒë·∫øn th·∫ø? 
Tr·∫£ l·ªùi: ƒê·∫ø qu·ªëc M·ªπ kh√¥ng nh·ªØng cƒÉm gh√©t m√† c√≤n s·ª£ h√£i Cu Ba. Kh√¥ng nh·ªØng s·ª£ h√£i Cu-Ba m√† c√≤n s·ª£ h√£i nh√¢n d√¢n lao ƒë·ªông c·∫£ ch√¢u M·ªπ Latinh. B·ªüi v√¨, Cu Ba l√† n∆∞·ªõc ƒë·∫ßu ti√™n ·ªü ch√¢u M·ªπ ƒëang th·ª±c hi·ªán h·ªçc thuy·∫øt M√°c - L√™nin, ƒëang anh d≈©ng ch·ªëng ƒë·∫ø qu·ªëc M·ªπ, ƒëang x√¢y d·ª±ng ch·ªß nghƒ©a x√£ h·ªôi. B·ªüi v√¨, Cu Ba ƒëang m·ªü ƒë∆∞·ªùng c√°ch m·∫°ng m√† nh√¢n d√¢n c√°c n∆∞·ªõc ch√¢u M·ªπ Latinh s·∫Ω ti·∫øn theo ƒë·ªÉ t·ª± gi·∫£i ph√≥ng kh·ªèi √°ch n√¥ l·ªá c·ªßa ƒë·∫ø qu·ªëc M·ªπ. Trong 13 tri·ªáu d√¢n P√™ru, h∆°n 10 tri·ªáu l√† ng∆∞·ªùi b·∫ßn c√πng. Nh√¢n d√¢n c√°c n∆∞·ªõc kh√°c ·ªü ch√¢u M·ªπ Latinh c≈©ng trong t√¨nh tr·∫°ng nh∆∞ v·∫≠y, cho n√™n h·ªç ƒë·ªÅu nh√¨n v√†o Cu Ba, h·ªç ·ªßng h·ªô Cu Ba v√† ch·∫Øc h·ªç s·∫Ω ti·∫øn theo con ƒë∆∞·ªùng c√°ch m·∫°ng c·ªßa Cu Ba. D√π ƒë·∫ø qu·ªëc Hoa K·ª≥ v√† b√® l≈© tay sai c·ªßa ch√∫ng hung √°c m·∫•y, ch√∫ng c≈©ng kh√¥ng ngƒÉn ƒë∆∞·ª£c phong tr√†o gi·∫£i ph√≥ng d√¢n t·ªôc th·∫Øng l·ª£i ti·∫øn l√™n ·ªü ch√¢u M·ªπ Latinh c≈©ng nh∆∞ ·ªü mi·ªÅn Nam Vi·ªát Nam ta!"`;
const PASSAGE_CUBA_CITE = '(H·ªì Ch√≠ Minh To√†n t·∫≠p: t·∫≠p 14, NXB Ch√≠nh tr·ªã Qu·ªëc gia, H√† N·ªôi, 2011, trang 35, 36)';

const PART2_ORIG = [
  {
    id:'p2_1',intro:'Cho nh·ªØng th√¥ng tin trong b·∫£ng sau ƒë√¢y:',
    tableData:[
      ['Th·ªùi gian','Ho·∫°t ƒë·ªông'],
      ['1/1973','Hi·ªáp ƒë·ªãnh Paris ƒë∆∞·ª£c k√Ω k·∫øt.'],
      ['1/1975','Chi·∫øn th·∫Øng Ph∆∞·ªõc Long.'],
      ['3/1975','Chi·∫øn d·ªãch T√¢y Nguy√™n th·∫Øng l·ª£i.'],
      ['4/1975','Chi·∫øn d·ªãch H·ªì Ch√≠ Minh th·∫Øng l·ª£i.'],
      ['5/1975','T·ªânh Ch√¢u ƒê·ªëc ƒë∆∞·ª£c gi·∫£i ph√≥ng.'],
    ],
    subs:[
      {label:'a',text:'T∆∞ li·ªáu ƒë·ªÅ c·∫≠p ƒë·∫øn nh·ªØng th·∫Øng l·ª£i quan tr·ªçng c·ªßa qu√¢n d√¢n Vi·ªát Nam trong giai ƒëo·∫°n cu·ªëi c·ªßa kh√°ng chi·∫øn ch·ªëng M·ªπ.',ans:true},
      {label:'b',text:'V·ªõi Hi·ªáp ƒë·ªãnh Paris, Vi·ªát Nam ƒë√£ bu·ªôc M·ªπ xu·ªëng thang chi·∫øn tranh, m·ªü ra b∆∞·ªõc ngo·∫∑t vƒ© ƒë·∫°i cho cu·ªôc kh√°ng chi·∫øn.',ans:false},
      {label:'c',text:'Chi·∫øn d·ªãch T√¢y Nguy√™n th·∫Øng l·ª£i l√† tr·∫≠n trinh s√°t chi·∫øn l∆∞·ª£c ƒë·ªÉ c·ªßng c·ªë quy·∫øt t√¢m gi·∫£i ph√≥ng mi·ªÅn Nam trong nƒÉm 1975.',ans:false},
      {label:'d',text:'V·ªõi vi·ªác t·ªânh Ch√¢u ƒê·ªëc ƒë∆∞·ª£c gi·∫£i ph√≥ng, cu·ªôc T·ªïng ti·∫øn c√¥ng v√† n·ªïi d·∫≠y Xu√¢n 1975 ƒë√£ k·∫øt th√∫c th·∫Øng l·ª£i tr·ªçn v·∫πn.',ans:true},
    ]
  },
  {
    id:'p2_2',intro:'Cho ƒëo·∫°n t∆∞ li·ªáu sau ƒë√¢y:',
    passage:`"M·ªôt b√™n l√† M·ªπ v√† Anh gi√∫p th·ª±c d√¢n Ph√°p x√¢m l∆∞·ª£c n∆∞·ªõc ta, gi√∫p b·ªçn b√π nh√¨n ph·∫£n qu·ªëc chia r·∫Ω nh√¢n d√¢n ta. M·ªôt b√™n, phe d√¢n ch·ªß ·ªßng h·ªô cu·ªôc kh√°ng chi·∫øn c·ªßa ta, ƒê·∫°i h·ªôi h√≤a b√¨nh th·∫ø gi·ªõi ƒë√≤i Ph√°p ch·∫•m d·ª©t chi·∫øn tranh phi nghƒ©a ·ªü n∆∞·ªõc ta; nh√¢n d√¢n Ph√°p hƒÉng h√°i ƒë·∫•u tranh ƒë√≤i qu√¢n ƒë·ªôi th·ª±c d√¢n ph·∫£i r√∫t kh·ªèi n∆∞·ªõc ta. Ngo√†i c√°c l√Ω do kh√°c, ƒë√≥ l√† nh·ªØng l√Ω do gi·∫£n ƒë∆°n, g·∫ßn g≈©i khi·∫øn cho nh√¢n d√¢n ta ph·∫£i hƒÉng h√°i ·ªßng h·ªô phong tr√†o h√≤a b√¨nh th·∫ø gi·ªõi. Ta ·ªßng h·ªô h√≤a b√¨nh th·∫ø gi·ªõi b·∫±ng c√°ch g√¨? B·∫±ng c√°ch l√†m cho l≈© ƒë·∫ø qu·ªëc g√¢y chi·∫øn y·∫øu ƒëi t·ª©c l√† b·∫±ng c√°ch ra s·ª©c kh√°ng chi·∫øn ƒë·ªÉ ti√™u di·ªát th·ª±c d√¢n Ph√°p v√† ƒë√°nh ƒë·ªï b·ªçn can thi·ªáp M·ªπ. B·∫±ng c√°ch ra s·ª©c ƒë·∫©y m·∫°nh thi ƒëua √°i qu·ªëc. M·ªói binh sƒ© ti√™u di·ªát th√™m m·ªôt t√™n ƒë·ªãch, m·ªói c√¥ng nh√¢n s·∫£n xu·∫•t th√™m m·ªôt vi√™n ƒë·∫°n, m·ªói n√¥ng d√¢n s·∫£n xu·∫•t th√™m m·ªôt c√¢n th√≥c.`,
    cite:'(H·ªì Ch√≠ Minh To√†n t·∫≠p: t·∫≠p 7, NXB Ch√≠nh tr·ªã Qu·ªëc gia, H√† N·ªôi, 2011, trang 89)',
    subs:[
      {label:'a',text:'T∆∞ li·ªáu ƒë·ªÅ c·∫≠p ƒë·∫øn phong tr√†o thi ƒëua y√™u n∆∞·ªõc trong cu·ªôc kh√°ng chi·∫øn ch·ªëng M·ªπ c·ª©u n∆∞·ªõc c·ªßa nh√¢n d√¢n Vi·ªát Nam.',ans:false},
      {label:'b',text:'Phong tr√†o thi ƒëua y√™u n∆∞·ªõc ƒë√£ th√∫c ƒë·∫©y, ph√°t huy cao ƒë·ªô truy·ªÅn th·ªëng d√¢n t·ªôc v√† th·ªÉ hi·ªán tinh th·∫ßn ƒëo√†n k·∫øt qu·ªëc t·∫ø.',ans:true},
      {label:'c',text:'Cu·ªôc kh√°ng chi·∫øn c·ªßa nh√¢n d√¢n Vi·ªát Nam ƒë∆∞·ª£c th·∫ø gi·ªõi ·ªßng h·ªô v√¨ Vi·ªát Nam l√† n∆∞·ªõc thu·ªôc ƒë·ªãa ƒë·∫ßu ti√™n gi√†nh ƒë·ªôc l·∫≠p.',ans:false},
      {label:'d',text:'Cu·ªôc kh√°ng chi·∫øn c·ªßa nh√¢n d√¢n Vi·ªát Nam c√≥ t√≠nh ch√≠nh nghƒ©a l√† do phe d√¢n ch·ªß ·ªßng h·ªô Vi·ªát Nam kh√°ng chi·∫øn.',ans:false},
    ]
  },
  {
    id:'p2_3',intro:'Cho ƒëo·∫°n t∆∞ li·ªáu sau ƒë√¢y:',
    passage:`"S·ª± th·ª±c l√† t·ª´ m√πa thu nƒÉm 1940, n∆∞·ªõc ta ƒë√£ th√†nh thu·ªôc ƒë·ªãa c·ªßa Nh·∫≠t, ch·ª© kh√¥ng ph·∫£i thu·ªôc ƒë·ªãa c·ªßa Ph√°p n·ªØa. Khi Nh·∫≠t h√†ng ƒê·ªìng minh th√¨ nh√¢n d√¢n c·∫£ n∆∞·ªõc ta ƒë√£ n·ªïi d·∫≠y gi√†nh ch√≠nh quy·ªÅn, l·∫≠p n√™n n∆∞·ªõc Vi·ªát Nam C·ªông h√≤a D√¢n ch·ªß. S·ª± th·ª±c l√† d√¢n ta ƒë√£ l·∫•y l·∫°i n∆∞·ªõc Vi·ªát Nam t·ª´ tay Nh·∫≠t, ch·ª© kh√¥ng ph·∫£i t·ª± tay Ph√°p. Ph√°p ch·∫°y, Nh·∫≠t h√†ng, vua B·∫£o ƒê·∫°i tho√°i v·ªã. D√¢n ta ƒë√£ ƒë√°nh ƒë·ªï c√°c xi·ªÅng x√≠ch th·ª±c d√¢n g·∫ßn 100 nƒÉm nay ƒë·ªÉ g√¢y n√™n n∆∞·ªõc Vi·ªát Nam ƒë·ªôc l·∫≠p. D√¢n ta l·∫°i ƒë√°nh ƒë·ªï ch·∫ø ƒë·ªô qu√¢n ch·ªß m·∫•y m∆∞∆°i th·∫ø k·ª∑ m√† l·∫≠p n√™n ch·∫ø ƒë·ªô D√¢n ch·ªß C·ªông h√≤a. B·ªüi th·∫ø cho n√™n, ch√∫ng t√¥i - L√¢m th·ªùi Ch√≠nh ph·ªß c·ªßa n∆∞·ªõc Vi·ªát Nam m·ªõi - ƒë·∫°i bi·ªÉu cho to√†n d√¢n Vi·ªát Nam, tuy√™n b·ªë tho√°t ly h·∫≥n quan h·ªá th·ª±c d√¢n v·ªõi Ph√°p, xo√° b·ªè h·∫øt nh·ªØng hi·ªáp ∆∞·ªõc m√† Ph√°p ƒë√£ k√Ω v·ªÅ n∆∞·ªõc Vi·ªát Nam, xo√° b·ªè t·∫•t c·∫£ m·ªçi ƒë·∫∑c quy·ªÅn c·ªßa Ph√°p tr√™n ƒë·∫•t n∆∞·ªõc Vi·ªát Nam. To√†n d√¢n Vi·ªát Nam, tr√™n d∆∞·ªõi m·ªôt l√≤ng quy·∫øt li·ªát ch·ªëng l·∫°i √¢m m∆∞u c·ªßa b·ªçn th·ª±c d√¢n Ph√°p."`,
    cite:'(H·ªì Ch√≠ Minh To√†n t·∫≠p: t·∫≠p 4, NXB Ch√≠nh tr·ªã Qu·ªëc gia, H√† N·ªôi, 2011, trang 3)',
    subs:[
      {label:'a',text:'T∆∞ li·ªáu tr√≠ch t·ª´ b·∫£n Tuy√™n ng√¥n ƒê·ªôc l·∫≠p c·ªßa n∆∞·ªõc Vi·ªát Nam D√¢n ch·ªß C·ªông h√≤a trong c√°ch m·∫°ng th√°ng T√°m nƒÉm 1945.',ans:true},
      {label:'b',text:'T∆∞ li·ªáu ƒë√£ kh·∫≥ng ƒë·ªãnh s·ª± t·ªìn t·∫°i c·ªßa n∆∞·ªõc Vi·ªát Nam D√¢n ch·ªß C·ªông h√≤a ·ªü tr√™n c·∫£ hai ph∆∞∆°ng di·ªán ph√°p l√Ω v√† th·ª±c ti·ªÖn.',ans:true},
      {label:'c',text:'"Ph√°p ch·∫°y, Nh·∫≠t h√†ng, vua B·∫£o ƒê·∫°i tho√°i v·ªã" ƒë√£ th·ªÉ hi·ªán t√≠nh d√¢n t·ªôc v√† d√¢n ch·ªß c·ªßa c√°ch m·∫°ng th√°ng T√°m ·ªü Vi·ªát Nam.',ans:true},
      {label:'d',text:'V·ªõi c√°ch m·∫°ng th√°ng T√°m, l·∫ßn ƒë·∫ßu ti√™n, nh√¢n d√¢n Vi·ªát Nam ƒë√£ ƒë√°nh b·∫°i k·∫ª th√π x√¢m l∆∞·ª£c v√† x√¢y d·ª±ng nh√† n∆∞·ªõc ƒë·ªôc l·∫≠p.',ans:false},
    ]
  },
  {
    id:'p2_4',intro:'Cho ƒëo·∫°n t∆∞ li·ªáu sau ƒë√¢y:',
    passage:`"Th·∫Øng l·ª£i c·ªßa cu·ªôc ti·∫øn c√¥ng chi·∫øn l∆∞·ª£c ƒê√¥ng - Xu√¢n 1953 - 1954 v√† chi·∫øn d·ªãch l·ªãch s·ª≠ ƒêi·ªán Bi√™n Ph·ªß c√≥ √Ω nghƒ©a r·∫•t to l·ªõn. Th·∫Øng l·ª£i ƒë√≥ b·∫Øt ngu·ªìn t·ª´ s·ª± l√£nh ƒë·∫°o s√°ng su·ªët c·ªßa Trung ∆∞∆°ng ƒê·∫£ng v√† Ch·ªß t·ªãch H·ªì Ch√≠ Minh, c·ªßa T·ªïng Qu√¢n ·ªßy v√† B·ªô T·ªïng t∆∞ l·ªánh ƒë√£ ch·ªâ huy ki√™n quy·∫øt v·ªØng v√†ng v√† ch√≠nh x√°c. B·ªô ƒë·ªôi tr√™n m·∫∑t tr·∫≠n ƒêi·ªán Bi√™n Ph·ªß ƒë√£ quy·∫øt t√¢m ti√™u di·ªát ƒë·ªãch, ch·ªãu ƒë·ª±ng m·ªçi hy sinh gian kh·ªï, anh d≈©ng chi·∫øn ƒë·∫•u. B·ªô ƒë·ªôi v√† d√¢n qu√¢n du k√≠ch tr√™n kh·∫Øp c√°c chi·∫øn tr∆∞·ªùng to√†n qu·ªëc ƒë√£ t√≠ch c·ª±c, li√™n t·ª•c ho·∫°t ƒë·ªông ph·ªëi h·ª£p chi·∫øn ƒë·∫•u c√≥ hi·ªáu qu·∫£."`,
    cite:'Nguy·ªÖn VƒÉn Nh·∫≠t, L·ªãch s·ª≠ Vi·ªát Nam, t·∫≠p 11 (2017), NXB Khoa h·ªçc x√£ h·ªôi, trang 428',
    subs:[
      {label:'a',text:'T∆∞ li·ªáu ƒë·ªÅ c·∫≠p ƒë·∫øn th·∫Øng l·ª£i qu√¢n s·ª± l·ªõn nh·∫•t c·ªßa qu√¢n d√¢n Vi·ªát Nam trong cu·ªôc kh√°ng chi·∫øn ch·ªëng th·ª±c d√¢n Ph√°p.',ans:true},
      {label:'b',text:'V·ªõi chi·∫øn th·∫Øng ƒêi·ªán Bi√™n Ph·ªß, l·∫ßn ƒë·∫ßu ti√™n qu√¢n d√¢n Vi·ªát Nam ƒë√£ ƒë√°nh th·∫Øng Ph√°p trong m·ªôt chi·∫øn d·ªãch qu√¢n s·ª± l·ªõn.',ans:false},
      {label:'c',text:'S·ª± l√£nh ƒë·∫°o c·ªßa ƒê·∫£ng v√† H·ªì Ch·ªß t·ªãch l√† nguy√™n nh√¢n quy·∫øt ƒë·ªãnh d·∫´n ƒë·∫øn th·∫Øng l·ª£i c·ªßa chi·∫øn d·ªãch ƒêi·ªán Bi√™n Ph·ªß.',ans:true},
      {label:'d',text:'Chi·∫øn d·ªãch ƒêi·ªán Bi√™n Ph·ªß th·∫Øng l·ª£i ƒë√£ th·ªÉ hi·ªán s·ª± ph·ªëi h·ª£p t√†i t√¨nh c·ªßa ngh·ªá thu·∫≠t chi·∫øn tranh nh√¢n d√¢n, to√†n d√¢n.',ans:true},
    ]
  },
];

// ============================================================
// STATE
// ============================================================
let part1Qs=[],part2Qs=[],answers={},submitted=false,timerInterval=null,timeLeft=45*60,totalQ=0;

// ============================================================
// UTILS
// ============================================================
function shuffle(arr){const a=[...arr];for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}
function L(i){return['A','B','C','D'][i];}
function el(tag,cls,txt){const e=document.createElement(tag);e.className=cls;if(txt!==undefined)e.textContent=txt;return e;}

// ============================================================
// TIMER
// ============================================================
function startTimer(){
  updateTimer();
  timerInterval=setInterval(()=>{timeLeft--;updateTimer();if(timeLeft<=0){clearInterval(timerInterval);if(!submitted)submitQuiz(true);}},1000);
}
function updateTimer(){
  const m=Math.floor(timeLeft/60),s=timeLeft%60;
  const d=document.getElementById('timerDisplay');
  d.textContent=`${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  d.className='timer-display'+(timeLeft<=60?' warning':timeLeft<=300?' caution':'');
}
function updateProgress(){
  const done=Object.keys(answers).length,pct=Math.round(done/totalQ*100);
  document.getElementById('progressBar').style.width=pct+'%';
  document.getElementById('progressPct').textContent=pct+'%';
  document.getElementById('liveScore').textContent=`ƒê√£ tr·∫£ l·ªùi: ${done} / ${totalQ} c√¢u`;
}

// ============================================================
// SCORE
// ============================================================
function calcScore(){
  let p1c=0;
  for(const q of part1Qs){if(answers[q.id]===q.displayAns)p1c++;}
  const p1s=p1c*0.25;
  let p2s=0;const p2d=[];
  for(const q of part2Qs){
    let c=0;
    for(const sub of q.subs){if(answers[q.id+'_'+sub.label]===(sub.ans?'true':'false'))c++;}
    const pts=c===4?1:c===3?.5:c===2?.25:c===1?.1:0;
    p2s+=pts;p2d.push({q,c,pts});
  }
  return{p1s,p1c,p2s,p2d,total:p1s+p2s};
}

// ============================================================
// BUILD
// ============================================================
function buildQuiz(){
  part1Qs=shuffle(PART1_ORIG).map(q=>{
    const pairs=q.opts.map((o,i)=>({t:o,orig:L(i)}));
    const sh=shuffle(pairs);
    return{...q,dispOpts:sh.map(o=>o.t),displayAns:L(sh.findIndex(o=>o.orig===q.ans))};
  });
  part2Qs=shuffle(PART2_ORIG);
  totalQ=part1Qs.length+part2Qs.reduce((s,q)=>s+q.subs.length,0);

  const c=document.getElementById('quizContainer');
  c.innerHTML='';

  // PART 1
  c.appendChild(el('div','section-title','‚ú¶ PH·∫¶N I: Tr·∫Øc nghi·ªám m·ªôt ƒë√°p √°n'));
  c.appendChild(el('div','section-desc','Th√≠ sinh tr·∫£ l·ªùi c√¢u h·ªèi t·ª´ 1 ƒë·∫øn 24. M·ªói c√¢u h·ªèi th√≠ sinh ch·ªâ ch·ªçn m·ªôt ph∆∞∆°ng √°n. M·ªói c√¢u ƒë√∫ng ƒë∆∞·ª£c 0,25 ƒëi·ªÉm.'));
  c.appendChild(el('div','shuffle-notice','* Th·ª© t·ª± c√¢u h·ªèi v√† ph∆∞∆°ng √°n ƒë√£ ƒë∆∞·ª£c x√°o tr·ªôn ng·∫´u nhi√™n'));

  let passageShown={};
  part1Qs.forEach((q,idx)=>{
    // Show passage before passage questions
    if(q.passage==='cuba' && !passageShown.cuba){
      passageShown.cuba=true;
      const pg=document.createElement('div');
      pg.className='passage-group';
      pg.innerHTML=`<div class="passage-label">üìú ƒê·ªåC T∆Ø LI·ªÜU ‚Äì Tr·∫£ l·ªùi c√¢u h·ªèi ti·∫øp theo</div>
        <div class="source-box"><p class="source-text">${PASSAGE_CUBA.replace(/\n/g,'<br>')}</p><span class="source-cite">${PASSAGE_CUBA_CITE}</span></div>`;
      c.appendChild(pg);
    }

    const card=document.createElement('div');
    card.className='question-card';card.id='card_'+q.id;
    card.innerHTML=`
      <div class="question-header"><span class="question-num">C√¢u ${idx+1}</span><span class="question-text">${q.q}</span></div>
      <div class="options-grid" id="opts_${q.id}">
        ${q.dispOpts.map((o,i)=>`<button class="option-btn" onclick="selP1('${q.id}','${L(i)}')" id="opt_${q.id}_${L(i)}"><span class="option-letter">${L(i)}</span><span>${o}</span></button>`).join('')}
      </div>
      <div class="answer-feedback" id="fb_${q.id}"></div>`;
    c.appendChild(card);
  });

  // PART 2
  c.appendChild(el('div','section-title','‚ú¶ PH·∫¶N II: ƒê√∫ng / Sai (4 √Ω m·ªói c√¢u)'));
  c.appendChild(el('div','section-desc','Th√≠ sinh tr·∫£ l·ªùi c√¢u h·ªèi t·ª´ 1 ƒë·∫øn 4. Trong m·ªói √Ω a), b), c), d), th√≠ sinh ch·ªçn ƒê√∫ng ho·∫∑c Sai. Thang ƒëi·ªÉm: 1 √Ω ƒë√∫ng = 0,1ƒë | 2 √Ω ƒë√∫ng = 0,25ƒë | 3 √Ω ƒë√∫ng = 0,5ƒë | 4 √Ω ƒë√∫ng = 1,0ƒë.'));

  part2Qs.forEach((q,qi)=>{
    const card=document.createElement('div');
    card.className='question-card';card.id='card_'+q.id;
    let html=`<div class="question-header"><span class="question-num">C√¢u ${qi+1}</span><span class="question-text">${q.intro}</span></div>`;
    if(q.tableData){
      html+=`<div class="source-box"><table class="info-table">${q.tableData.map((r,ri)=>`<tr>${r.map(cell=>ri===0?`<th>${cell}</th>`:`<td>${cell}</td>`).join('')}</tr>`).join('')}</table></div>`;
    } else if(q.passage){
      html+=`<div class="source-box"><p class="source-text">${q.passage.replace(/\n/g,'<br>')}</p><span class="source-cite">${q.cite}</span></div>`;
    }
    q.subs.forEach(sub=>{
      const k=q.id+'_'+sub.label;
      html+=`<div class="sub-q"><div class="sub-q-text"><span class="sub-q-label">${sub.label})</span>${sub.text}</div>
        <div class="tf-options"><button class="tf-btn" onclick="selTF('${k}','true')" id="tf_${k}_true">‚úì ƒê√∫ng</button><button class="tf-btn" onclick="selTF('${k}','false')" id="tf_${k}_false">‚úó Sai</button></div>
        <div class="answer-feedback" id="fb_${k}"></div></div>`;
    });
    card.innerHTML=html;
    c.appendChild(card);
  });

  const act=document.createElement('div');
  act.className='action-area';
  act.innerHTML=`<button class="submit-btn" onclick="submitQuiz(false)" id="submitBtn">‚ú¶ &nbsp; N·ªòP B√ÄI &nbsp; ‚ú¶</button><br><button class="restart-btn" onclick="restartQuiz()" id="restartBtn">‚Ü∫ &nbsp; L√ÄM L·∫†I B√ÄI</button>`;
  c.appendChild(act);
}

// ============================================================
// INTERACT
// ============================================================
function selP1(id,letter){
  if(submitted)return;
  answers[id]=letter;
  const q=part1Qs.find(x=>x.id===id);
  q.dispOpts.forEach((_,i)=>{
    document.getElementById('opt_'+id+'_'+L(i)).classList.toggle('selected',L(i)===letter);
  });
  updateProgress();
}
function selTF(key,val){
  if(submitted)return;
  answers[key]=val;
  const tb=document.getElementById('tf_'+key+'_true');
  const fb=document.getElementById('tf_'+key+'_false');
  tb.classList.remove('sel-true','sel-false');fb.classList.remove('sel-true','sel-false');
  if(val==='true')tb.classList.add('sel-true');else fb.classList.add('sel-false');
  updateProgress();
}

// ============================================================
// SUBMIT
// ============================================================
function submitQuiz(auto){
  if(submitted)return;
  if(!auto){
    const un=totalQ-Object.keys(answers).length;
    if(un>0&&!confirm(`B·∫°n c√≤n ${un} c√¢u ch∆∞a tr·∫£ l·ªùi. C√≥ ch·∫Øc ch·∫Øn mu·ªën n·ªôp b√†i?`))return;
  }
  submitted=true;clearInterval(timerInterval);
  document.getElementById('submitBtn').style.display='none';
  document.getElementById('restartBtn').style.display='inline-block';

  part1Qs.forEach(q=>{
    const sel=answers[q.id],cor=q.displayAns;
    q.dispOpts.forEach((_,i)=>{
      const l=L(i),btn=document.getElementById('opt_'+q.id+'_'+l);
      btn.disabled=true;btn.classList.remove('selected');
      if(l===cor)btn.classList.add('correct');
      else if(l===sel&&sel!==cor)btn.classList.add('wrong');
    });
    const fb=document.getElementById('fb_'+q.id);fb.classList.add('show');
    if(!sel)fb.innerHTML=`<span class="feedback-wrong">‚ö† Ch∆∞a tr·∫£ l·ªùi. ƒê√°p √°n ƒë√∫ng: <strong>${cor}</strong></span>`;
    else if(sel===cor)fb.innerHTML=`<span class="feedback-correct">‚úî Ch√≠nh x√°c! ƒê√°p √°n: <strong>${cor}</strong></span>`;
    else fb.innerHTML=`<span class="feedback-wrong">‚úò Sai. B·∫°n ch·ªçn <strong>${sel}</strong> ‚Äì ƒê√°p √°n ƒë√∫ng: <strong>${cor}</strong></span>`;
  });

  part2Qs.forEach(q=>{
    q.subs.forEach(sub=>{
      const k=q.id+'_'+sub.label,sel=answers[k],cor=sub.ans?'true':'false';
      const tb=document.getElementById('tf_'+k+'_true'),fb2=document.getElementById('tf_'+k+'_false');
      tb.disabled=true;fb2.disabled=true;
      tb.classList.remove('sel-true','sel-false');fb2.classList.remove('sel-true','sel-false');
      if(!sel){if(cor==='true')tb.classList.add('tf-correct');else fb2.classList.add('tf-correct');}
      else if(sel===cor){if(cor==='true')tb.classList.add('tf-correct');else fb2.classList.add('tf-correct');}
      else{if(sel==='true')tb.classList.add('tf-wrong');else fb2.classList.add('tf-wrong');if(cor==='true')tb.classList.add('tf-correct');else fb2.classList.add('tf-correct');}
      const fbb=document.getElementById('fb_'+k);fbb.classList.add('show');
      const at=sub.ans?'ƒê√öNG':'SAI';
      if(!sel)fbb.innerHTML=`<span class="feedback-wrong">‚ö† Ch∆∞a tr·∫£ l·ªùi. ƒê√°p √°n: <strong>${at}</strong></span>`;
      else if(sel===cor)fbb.innerHTML=`<span class="feedback-correct">‚úî Ch√≠nh x√°c!</span>`;
      else fbb.innerHTML=`<span class="feedback-wrong">‚úò Sai. ƒê√°p √°n ƒë√∫ng: <strong>${at}</strong></span>`;
    });
  });
  showResults();
}

function showResults(){
  const {p1s,p1c,p2s,p2d,total}=calcScore();
  const rnd=Math.round(total*100)/100;
  let grade,gc;
  if(total>=8){grade='Gi·ªèi';gc='grade-a';}else if(total>=6.5){grade='Kh√°';gc='grade-b';}else if(total>=5){grade='Trung b√¨nh';gc='grade-c';}else{grade='Y·∫øu';gc='grade-d';}
  const p2html=p2d.map((d,i)=>`<div class="breakdown-row"><span>C√¢u ${i+1} Ph·∫ßn II (${d.c}/4 √Ω ƒë√∫ng)</span><span style="font-weight:600;">${d.pts.toFixed(2)} ƒëi·ªÉm</span></div>`).join('');
  const modal=document.createElement('div');
  modal.className='modal-overlay show';modal.id='resultsModal';
  modal.innerHTML=`<div class="modal">
    <div class="modal-header"><div class="ornament">‚ú¶ ‚ú¶ ‚ú¶</div><div class="modal-title">K·∫æT QU·∫¢ B√ÄI THI</div><div class="ornament" style="margin-top:8px;">‚ú¶ ‚ú¶ ‚ú¶</div></div>
    <div class="modal-body">
      <div class="score-big"><div class="score-number">${rnd.toFixed(2)}</div><div class="score-total">/ 10.0 ƒëi·ªÉm</div><div><span class="score-grade ${gc}">${grade}</span></div></div>
      <div class="score-breakdown"><div class="breakdown-title">CHI TI·∫æT ƒêI·ªÇM S·ªê</div>
        <div class="breakdown-row"><span>Ph·∫ßn I (${p1c}/24 c√¢u ƒë√∫ng √ó 0,25ƒë)</span><span style="font-weight:600;">${p1s.toFixed(2)} ƒëi·ªÉm</span></div>
        ${p2html}
        <div class="breakdown-row" style="font-weight:700;border-top:2px solid var(--gold);margin-top:4px;padding-top:8px;"><span>T·ªîNG ƒêI·ªÇM</span><span style="color:var(--gold);">${rnd.toFixed(2)} / 10.00</span></div>
      </div>
      <div class="btn-group"><button class="modal-btn modal-btn-primary" onclick="closeModal()">‚ú¶ Xem ƒê√°p √Ån</button><button class="modal-btn modal-btn-secondary" onclick="restartQuiz()">‚Ü∫ L√†m L·∫°i</button></div>
    </div></div>`;
  document.body.appendChild(modal);
}

function closeModal(){const m=document.getElementById('resultsModal');if(m)m.remove();}
function restartQuiz(){
  closeModal();answers={};submitted=false;timeLeft=45*60;clearInterval(timerInterval);
  buildQuiz();updateProgress();startTimer();window.scrollTo({top:0,behavior:'smooth'});
}

buildQuiz();updateProgress();startTimer();
</script>
</body>
</html>

